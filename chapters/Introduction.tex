%This article is the main product of the $7$th-semester project on the MSc degree in Control and Automation at Aalborg university. The project focuses on the subject of Water Distributed Networks (WDN), specifically modelling and control of these. Control strategies used include Linearâ€“quadratic regulator (LQR) and Proportional Integral controller (PI). Further more Kalmann filter is used to estimate shit.... The project also investigates packet-loss in the feedback loop to the LQR. 

Water Distribution Networks (WDN) are a key infrastructure element that facilitates the supply of drinking water from a water source to end users. They consist of pumping stations, consumers, a network of pipes, and typically one or more elevated water reservoirs (EWR) \cite{Swamee2008}. The latter in particular play an important role in pressure regulation, peak demand matching, and backup supply in case of e.g. pump failure \cite{Creaco2019}. Furthermore, they allow for energy-efficient pump scheduling \cite{Rathore1030,Bello2019}.  

Failure to manage tank level appropriately relative to consumer demand may lead to system overpressure and an accompanying risk of pipe damage and water leakage when demand is low, or to system underpressure and insufficient service pressure provided to consumers when demand is high. Optimisation-based control schemes such as Model-Predictive-Control are common \cite{OcampoMartinez2013,Kallesoe2017}, with data-driven plug-and-play approaches appearing in recent years \cite{Val2020}, particularly for large-scale systems.  

This paper presents a cascaded optimal control paradigm that exploits the separability of WDN dynamics into a slow tank pressure regime and a fast flow regime. The slow dynamics are paired with a velocity-form Linear Quadratic Regulator (VF-LQR) as seen in e.g. \cite{Pannocchia2015a}, while the fast dynamics are paired with PID regulators. Rejection of unmeasured time-varying disturbances and leakage detection is achieved using a Kalman filter based on a harmonic model, improving on e.g. \cite{OcampoMartinez2013} and \cite{Val2020} which respectively assume measurable or constant disturbances.

The remainder of this paper is organised as follows: in \Cref{sec:SysModel} we develop models of the fast and slow regimes of the system, including a linearised model of the fast regime. \Cref{sec:ControlStructure} details the structure and design of the VF-LQR and PID controllers as well as the disturbance rejection. \Cref{sec:Results} presents simulation and experimental results, as well as an overview of the laboratory testbed. Finally, \Cref{sec:Conclusion} summarises the contributions made in the paper, as well as ideas pertaining to future work.